version: "3.9"

services:
  web:
    build: .
    image: roosnam-frontend:dev
    ports:
      - "3001:3001"  # Host:Container (Next.js runs on 3001)
    environment:
      NODE_ENV: development
      NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-http://backend:80/api/v1}
      NEXT_PUBLIC_SITE_URL: ${NEXT_PUBLIC_SITE_URL:-http://localhost:3001}
      NEXT_PUBLIC_SHOW_MOCK_DATA: ${NEXT_PUBLIC_SHOW_MOCK_DATA:-false}
      # For production, set these environment variables:
      # NEXT_PUBLIC_API_URL=https://api.yourdomain.com/api/v1
      # NEXT_PUBLIC_SITE_URL=https://yourdomain.com
    volumes:
      - .:/app
      - /app/node_modules
    # Write env vars to .env.local before starting (Next.js reads this file)
    command: >
      sh -c "echo 'NEXT_PUBLIC_API_URL='$$NEXT_PUBLIC_API_URL > /app/.env.local &&
             echo 'NEXT_PUBLIC_SITE_URL='$$NEXT_PUBLIC_SITE_URL >> /app/.env.local &&
             echo 'NEXT_PUBLIC_SHOW_MOCK_DATA='$$NEXT_PUBLIC_SHOW_MOCK_DATA >> /app/.env.local &&
             npm run dev -- -H 0.0.0.0 -p 3001"


